


   MESSAGE (length 1023 bytes):
08b8b2b733424243760fe426a4b54908632110a66c2f6591eabd3345e3e4eb98fa6e264bf09efe12ee50f8f54e9f77b1e355f6c50544e23fb1433ddf73be84d879de7c0046dc4996d9e773f4bc9efe5738829adb26c81b37c93a1b270b20329d658675fc6ea534e0810a4432826bf58c941efb65d57a338bbd2e26640f89ffbc1a858efcb8550ee3a5e1998bd177e93a7363c344fe6b199ee5d02e82d522c4feba15452f80288a821a579116ec6dad2b3b310da903401aa62100ab5d1a36553e06203b33890cc9b832f79ef80560ccb9a39ce767967ed628c6ad573cb116dbefefd75499da96bd68a8a97b928a8bbc103b6621fcde2beca1231d206be6cd9ec7aff6f6c94fcd7204ed3455c68c83f4a41da4af2b74ef5c53f1d8ac70bdcb7ed185ce81bd84359d44254d95629e9855a94a7c1958d1f8ada5d0532ed8a5aa3fb2d17ba70eb6248e594e1a2297acbbb39d502f1a8c6eb6f1ce22b3de1a1f40cc24554119a831a9aad6079cad88425de6bde1a9187ebb6092cf67bf2b13fd65f27088d78b7e883c8759d2c4f5c65adb7553878ad575f9fad878e80a0c9ba63bcbcc2732e69485bbc9c90bfbd62481d9089beccf80cfe2df16a2cf65bd92dd597b0707e0917af48bbb75fed413d238f5555a7a569d80c3414a8d0859dc65a46128bab27af87a71314f318c782b23ebfe808b82b0ce26401d2e22f04d83d1255dc51addd3b75a2b1ae0784504df543af8969be3ea7082ff7fc9888c144da2af58429ec96031dbcad3dad9af0dcbaaaf268cb8fcffead94f3c7ca495e056a9b47acdb751fb73e666c6c655ade8297297d07ad1ba5e43f1bca32301651339e22904cc8c42f58c30c04aafdb038dda0847dd988dcda6f3bfd15c4b4c4525004aa06eeff8ca61783aacec57fb3d1f92b0fe2fd1a85f6724517b65e614ad6808d6f6ee34dff7310fdc82aebfd904b01e1dc54b2927094b2db68d6f903b68401adebf5a7e08d78ff4ef5d63653a65040cf9bfd4aca7984a74d37145986780fc0b16ac451649de6188a7dbdf191f64b5fc5e2ab47b57f7f7276cd419c17a3ca8e1b939ae49e488acba6b965610b5480109c8b17b80e1b7b750dfc7598d5d5011fd2dcc5600a32ef5b52a1ecc820e308aa342721aac0943bf6686b64b2579376504ccc493d97e6aed3fb0f9cd71a43dd497f01f17c0e2cb3797aa2a2f256656168e6c496afc5fb93246f6b1116398a346f1a641f3b041e989f7914f90cc2c7fff357876e506b50d334ba77c225bc307ba537152f3f1610e4eafe595f6d9d90d11faa933a15ef1369546868a7f3a45a96768d40fd9d03412c091c6315cf4fde7cb68606937380db2eaaa707b4c4185c32eddcdd306705e4dc1ffc872eeee475a64dfac86aba41c0618983f8741c5ef68d3a101e8a3b8cac60c905c15fc910840b94c00a0b9d0



p38p : calculates Q.Z = (Q.Z)^((p+3)/8) mod p.

void Ed25519SignatureAlgorithm::p38p() { // Adapted from Daniel J. Bernstein.
	math.base16Mul(A, Q.Z, Q.Z);
	math.base16Mul(B, A, A);
	math.base16Mul(C, B, B);
	math.base16Mul(D, C, Q.Z);
	math.base16Mul(E, D, A);
	math.base16Mul(C, E, E);
	math.base16Mul(F, C, D);

	math.base16Mul(C, F, F);
	math.base16Mul(B, C, C);
	math.base16Mul(C, B, B);
	math.base16Mul(B, C, C);
	math.base16Mul(C, B, B);
	math.base16Mul(G, C, F);

	math.base16Mul(C, G, G);
	math.base16Mul(B, C, C);
	for(unsigned short i = 2; i < 10; i += 2) {
		math.base16Mul(C, B, B);
		math.base16Mul(B, C, C);
	}
	math.base16Mul(H, B, G);

	math.base16Mul(C, H, H);
	math.base16Mul(B, C, C);
	for(unsigned short i = 2; i < 20; i += 2) {
		math.base16Mul(C, B, B);
		math.base16Mul(B, C, C);
	}
	math.base16Mul(C, B, H);

	math.base16Mul(B, C, C);
	math.base16Mul(C, B, B);
	for(unsigned short i = 2; i < 10; i += 2) {
		math.base16Mul(B, C, C);
		math.base16Mul(C, B, B);
	}
	math.base16Mul(P.X, C, G);

	math.base16Mul(C, P.X, P.X);
	math.base16Mul(B, C, C);
	for(unsigned short i = 2; i < 50; i += 2) {
		math.base16Mul(C, B, B);
		math.base16Mul(B, C, C);
	}
	math.base16Mul(P.Y, B, P.X);

	math.base16Mul(B, P.Y, P.Y);
	math.base16Mul(C, B, B);
	for(unsigned short i = 2; i < 100; i += 2) {
		math.base16Mul(B, C, C);
		math.base16Mul(C, B, B);
	}
	math.base16Mul(B, C, P.Y);

	math.base16Mul(C, B, B);
	math.base16Mul(B, C, C);
	for(unsigned short i = 2; i < 50; i += 2) {
		math.base16Mul(C, B, B);
		math.base16Mul(B, C, C);
	}
	math.base16Mul(C, B, P.X);

	math.base16Mul(B, C, C);
	math.base16Mul(C, B, B);
	math.base16Mul(Q.Z, C, A);
}



2B8324804FC1DF0B2B4D00993DFBD7A72F431806AD2FE478C4EE1B274A0EA0B0
2B83 2480 4FC1 DF0B 2B4D 0099 3DFB D7A7 2F43 1806 AD2F E478 C4EE 1B27 4A0E A0B0
2b83 2480 4fc1 df0b 2b4d 0099 3dfb d7a7 2f43 1806 ad2f e478 c4ee 1b27 4a0e a0b0
0x00002b83 0x00002480 0x00004fc1 0x0000df0b 0x00002b4d 0x00000099 0x00003dfb 0x0000d7a7 0x00002f43 0x00001806 0x0000ad2f 0x0000e478 0x0000c4ee 0x00001b27 0x00004a0e 0x0000a0b0
0x00002b83, 0x00002480, 0x00004fc1, 0x0000df0b, 0x00002b4d, 0x00000099, 0x00003dfb, 0x0000d7a7, 0x00002f43, 0x00001806, 0x0000ad2f, 0x0000e478, 0x0000c4ee, 0x00001b27, 0x00004a0e, 0x0000a0b0


Odd Signature Return:
E6AE4F4181184FFBA68F3A3C49507D0CFB805CA87E57D13AE82F445B57A595C8F1838AF7351E2D52A74EC1C5B6FAC1F6DC1D0691993E747C0BCEBF114423D00D



BUG HUNTING:



Running
hashModOrder variables:
hashInt:
A493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A

base16Mod variables:
a:
A493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A
u:
ACDB3D9247366C6BA493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A
Post-mod u:
00572386C989775A4C181AD63DF92B2E2CBD82318787B893262A5E8A9FE4778FB572386C989775A4C181AD63DF92B2E2CBD82318787B893262A5E8A9FE4778FB
intOut:
572386C989775A4C181AD63DF92B2E2CBD82318787B893262A5E8A9FE4778FB

hashModOrder variables:
hashInt:
19423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB

base16Mod variables:
a:
19423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB
u:
0019423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB
Post-mod u:
007EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A7EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A
intOut:
7EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A

runtime: 7146
DCE765951D8D1181B20E047E75810730BDCA68EC127509FB132B2567276906BDA45EF64BBE5D33E29BB4BF4C699B54A9AA59E953118559A8609AC00DD0CCA003

hashModOrder variables:
hashInt:
19423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB

base16Mod variables:
a:
19423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB
u:
0019423734D211E24831342F87872B856F811828B784737C15CC60AC935A97C13B2AB5BE0575E4E9BCCC9478318E69B3BA7DE270F70414EC81766A3FB7759CFB
Post-mod u:
007EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A7EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A
intOut:
7EAD962B4BC56BCC3F8E4E1EA06198BB498B5CFE66699B6CE81F267831E82A

runtime: 7517
Valid signature.



Running
hashModOrder variables:
hashInt:
A493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A

base16Mod variables:
a:
A493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A
u:
00A493230E40C7E302CBC887AF8937373835BCB8D59FF33571AD445D632570AC7363EF1D786096F01F61DA1ABBAE79C222D252C93851F8003B81DE615D3BE501A
Post-mod u:
00556B81D690C181C2F3F6B7456EF58CE776A9C0AAF52A93886A09216A2F0E7F556B81D690C181C2F3F6B7456EF58CE776A9C0AAF52A93886A09216A2F0E7F
intOut:
556B81D690C181C2F3F6B7456EF58CE776A9C0AAF52A93886A09216A2F0E7F

hashModOrder variables:
hashInt:
BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09

base16Mod variables:
a:
BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09
u:
00BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09
Post-mod u:
0060AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E9560AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E95
intOut:
60AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E95

runtime: 7149
6291D657DEEC24024827E69C3ABE01A30CE548A284743A445E3680D7DB5AC3AC18FF9B538D16F290AE67F760984DC6594A7C15E9716ED28DC027BECEEA1EC40A

hashModOrder variables:
hashInt:
BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09

base16Mod variables:
a:
BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09
u:
00BF62C3FB850ACEBF2D24DF6FE5F136359AB6728DA6056E3C6DDABB4AE5748549EC08DF799A1BC959B0558F8675832C0648B4A939956F62E8FF39319FFB4BF09
Post-mod u:
0060AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E9560AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E95
intOut:
60AB51A60E3F1CEB60549479B152AE2F4A41D9DD8DAF6C3EF2892D51118E95

runtime: 7515
Valid signature.


---------------------------------------------------------------------

ORIGINAL:

Running
runtime: 7124
6291D657DEEC24024827E69C3ABE01A30CE548A284743A445E3680D7DB5AC3AC18FF9B538D16F290AE67F760984DC6594A7C15E9716ED28DC027BECEEA1EC40A

RX: 39A5 ED0 9FF5 6E66 F9DB 162C 5FB6 791A 98F 8F79 62A1 ED01 3293 448B BA5B 444F
RY: 2CC3 5ADB D780 365E 443A 7484 A248 E50C A301 BE3A 9CE6 2748 224 ECDE 57D6 9162
RZ: 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
RT: 1165 214 B1AE 9EF 4487 7AA D1E4 13F1 9C76 9590 DA72 FA3 A004 7560 C38E 65C8
s:AC41EEACEBE27C08DD26E71E9157C4A59C64D9860F767AE90F2168D539BFF18
k % L: 60A B51A 60E3 F1CE B605 4947 9B15 2AE2 F4A4 1D9D D8DA F6C 3EF2 892D 5111 8E95
[S]B X: 5C29 4825 2A3A 6689 6057 E3F3 40DA 2518 EAE7 B5E E1E5 2F5 D929 8F9A A9D8 8362
[S]B Y: 836 3DCB E25 5A57 753 428D 6F0A 467C 92FF 5B85 D364 D9E7 F157 ECAD B917 C64F
[S]B Z: 2013 F0DF 755D AE41 AA7A 9F5A E618 85FA A426 BD52 FD47 6E85 D756 2B47 34E1 F2F1
[k]A X: 5F5D 29A7 8181 F3E0 8572 C8B6 411B 2B3D 8CB9 72BE FFC0 773 72D1 A1A7 C337 2450
[k]A Y: 6102 3C67 E197 F409 D93B B0D4 302B A492 E811 D4F6 15D4 28D0 20B7 1EC6 5FD4 620
[k]A Z: 2C5C 3533 27F0 7694 E554 4BDB 2A88 6F43 3381 32EC 11F1 B40F 3B83 8E1E 9709 5A15
[k]A T: 26FA 6520 B9E9 7132 BB11 B4C2 6F74 C8E4 3B0E 11AE 224D 8601 5C28 6F44 72C4 A374
R + [k]A X: 4518 1136 B99F 56A8 2E83 8473 871C CD3C FD34 85F1 87F6 63FD 1C9A 5C17 4388 7FD5
R + [k]A Y: 44F6 BAF7 ADE5 F052 61DB 9B90 F384 A104 C37E CD9 AF26 90F0 9262 2CDB 9F44 7DDD
R + [k]A Z: 29DC 40A9 B419 5295 C29D 3350 B0A3 8C07 7065 C66C 9B17 6C0E A89A AC72 898A C2A7
R + [k]A T: 4711 ABE8 9177 DCCB 5397 31B5 4C68 D22B 663E 79BD 867E 1C6F 674 280A D327 63EB
runtime: 7539
Valid signature.


OUT-OF-THE-BLUE:

Running
runtime: 7125
6291D657DEEC24024827E69C3ABE01A30CE548A284743A445E3680D7DB5AC3AC18FF9B538D16F290AE67F760984DC6594A7C15E9716ED28DC027BECEEA1EC40A

E6AE4F4181184FFBA68F3A3C49507D0CFB805CA87E57D13AE82F445B57A595C8F1838AF7351E2D52A74EC1C5B6FAC1F6DC1D0691993E747C0BCEBF114423D00D

RX: D6E D124 7726 E166 7A41 7D15 11EE 2EE3 2727 747B F178 6609 3AD4 EF67 806 B3E9
RY: 4895 A557 5B44 2FE8 3AD1 577E A85C 80FB C7D 5049 3C3A 8FA6 FB4F 1881 414F AEE6
RZ: 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
RT: 1686 9702 62D7 75D9 6105 BDF9 3F9A AE6C CDE6 B4F9 8BFF 69CB FC32 B42F D186 50D0
s:DD0234411BFCEB7C743E999161DDCF6C1FAB6C5C14EA7522D1E35F78A83F1
k % L: BD1 34B1 A4A1 EB42 BEB9 F3D8 C5D7 74AA 3221 977C A1B5 E83 B910 CD29 238F 704B
[S]B X: 78C3 2948 CEFA 4718 FB46 D5A0 E80B A8B7 B42 705E 6DFC 2FA3 6610 1E79 F61A 3F9E
[S]B Y: 633 470E 789D 3CA4 7865 F086 834B EA67 D0F9 7D50 AFC3 A70C 54CC 9641 8E48 6C4E
[S]B Z: 3F66 F6F8 B9A5 73F6 1BC3 BAF0 F227 6FE1 178B C3C7 E2E2 F537 742E 78B9 92BE C65
[k]A X: 6A49 E2EA E07F 20EF 3225 1E7C 15E7 F28C 155D 899A 5C18 A875 F706 7B7B DA97 ABE
[k]A Y: 5DDB B187 6210 F339 4D27 B61E 8B15 F35A 9E37 3E41 6EB0 5BB4 A4A7 1582 984E 8340
[k]A Z: 19A2 DDCC 7F55 BB04 EB37 BC01 B27 1B1B 54FF AB06 2602 E70 1A75 1412 38DA 7811
[k]A T: 3138 4A4E 9DB3 3DCD DC58 811E 5BB6 9C1 E8B4 935D 3DB6 C951 B22 C415 66C0 D141
R + [k]A X: 1A2C F45D B960 BAED 5EA1 DAA0 2989 AB4D 128E 54B0 A020 43F5 B3CD A488 D00B B3BB
R + [k]A Y: 4DAC 11F8 4AF8 FE64 C012 4D33 A518 4D8A 4B2 B303 E541 9A24 A336 84FD 3CCA EEE6
R + [k]A Z: 800 C11F C14 1270 5828 3E52 3368 542D 9C99 CA0F 3434 1ED1 2A37 139F 4D67 D1C8
R + [k]A T: 421A 8522 FB69 7C47 893F 77C1 662D 3AA6 DCD3 504F FB08 BD83 2808 6294 2C94 CD8B
runtime: 7538
Valid signature.

(78C32948CEFA4718FB46D5A0E80BA8B70B42705E6DFC2FA366101E79F61A3F9E * 0800C11F0C14127058283E523368542D9C99CA0F34341ED12A37139F4D67D1C8) % p
-
(1A2CF45DB960BAED5EA1DAA02989AB4D128E54B0A02043F5B3CDA488D00BB3BB * 3F66F6F8B9A573F61BC3BAF0F2276FE1178BC3C7E2E2F537742E78B992BE0C65) % p
=
0

&&

(0633470E789D3CA47865F086834BEA67D0F97D50AFC3A70C54CC96418E486C4E * 0800C11F0C14127058283E523368542D9C99CA0F34341ED12A37139F4D67D1C8) % p
-
(4DAC11F84AF8FE64C0124D33A5184D8A04B2B303E5419A24A33684FD3CCAEEE6 * 3F66F6F8B9A573F61BC3BAF0F2276FE1178BC3C7E2E2F537742E78B992BE0C65) % p
=
0

Yup. This final check, at least, does in fact appear to be working as intended.


